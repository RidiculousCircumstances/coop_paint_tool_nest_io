<!DOCTYPE html>
<html>
	<head>
		<meta name="Authorization" content="11111111111111111111111111111">
		<script src="https://code.jquery.com/jquery-3.6.3.min.js"
				integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
		<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"
			integrity="sha384-/KNQL8Nu5gCHLqwqfQjA689Hhoqgi2S84SNUxC3roTe4EhJ9AfLkp8QiQcU8AMzI"
			crossorigin="anonymous"></script>
		<title>Отправка сообщения</title>
	</head>
	
	<body style="background-color: bisque;">
		<div style="background-color: rgb(0, 255, 76);
					width: 200px;
					height: 100px;
					position: relative;
					top: 200px;
					left: 100px">
			<input class="js-data" type="text">
			<button class="js-button">Отправить</button>
		</div>

		<div style="background-color: rgb(0, 255, 0);
					width: 200px;
					height: auto;
					position: relative;
					top: 400px;
					left: 100px">
			<ul class="js-messages">Сообщения:

			</ul>
		</div>

		</form>
	</body>
	<script>
		const token = "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6IjExMTIzMkBib2JvLnRvIiwiaWF0IjoxNjczNzA4NTcwfQ.Zmv1kLoTbQRt8DUPUVGvrbvtaiEQYqopj7T3W-gtiww"
		const url = "http://83.246.208.128:5000/message";
		const method = "post";
		const button = $('.js-button');

		const chatId = '71e080a5-1d29-463d-a57f-305f9b6dc3ba';

		const socket = io('ws://83.246.208.128:5000');

		socket.on('connect', () => {
			socket.emit('joinToChat', { chatId });
		});

		socket.on('chatMessage', (data) => {
			console.log(data);
		});



		const action = () => {
			const data = $('.js-data').val();

			$.ajax({
				url: url,
				type: method,
				data: {
					chatId: chatId,
					text: data,

				},
				beforeSend: (req) => {
					req.setRequestHeader("Authorization", token)
				},
				
				complete: (res) => { 
					
				}

				
			})
			
		}


		button.on('click', () => {
			action();
		});

		


	</script>
</html>